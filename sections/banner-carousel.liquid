{{ 'component-slideshow.css' | asset_url | stylesheet_tag }}
{{ 'component-slider.css' | asset_url | stylesheet_tag }}

{%- style -%}
  #BannerCarousel-{{ section.id }} .banner-carousel__button {
    background-color: {{ section.settings.button_color }};
    color: {{ section.settings.button_text_color }};
    border-radius: {{ section.settings.button_border_radius }}px;
    position: absolute;
    {%- if section.settings.button_use_custom_position_desktop -%}
      {%- if section.settings.button_top_desktop != blank -%}
        top: {{ section.settings.button_top_desktop }}px;
      {%- endif -%}
      {%- if section.settings.button_bottom_desktop != blank -%}
        bottom: {{ section.settings.button_bottom_desktop }}px;
      {%- endif -%}
      {%- if section.settings.button_left_desktop != blank -%}
        left: {{ section.settings.button_left_desktop }}px;
      {%- endif -%}
      {%- if section.settings.button_right_desktop != blank -%}
        right: {{ section.settings.button_right_desktop }}px;
      {%- endif -%}
      {%- if section.settings.button_center_horizontal_desktop and section.settings.button_center_vertical_desktop -%}
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      {%- elsif section.settings.button_center_horizontal_desktop -%}
        left: 50%;
        transform: translateX(-50%);
      {%- elsif section.settings.button_center_vertical_desktop -%}
        top: 50%;
        transform: translateY(-50%);
      {%- endif -%}
    {%- else -%}
      {%- case section.settings.button_position -%}
        {%- when 'top-left' -%}
          top: 2rem;
          left: 2rem;
        {%- when 'top-center' -%}
          top: 2rem;
          left: 50%;
          transform: translateX(-50%);
        {%- when 'top-right' -%}
          top: 2rem;
          right: 2rem;
        {%- when 'middle-left' -%}
          top: 50%;
          left: 2rem;
          transform: translateY(-50%);
        {%- when 'middle-center' -%}
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        {%- when 'middle-right' -%}
          top: 50%;
          right: 2rem;
          transform: translateY(-50%);
        {%- when 'bottom-left' -%}
          bottom: 2rem;
          left: 2rem;
        {%- when 'bottom-center' -%}
          bottom: 2rem;
          left: 50%;
          transform: translateX(-50%);
        {%- when 'bottom-right' -%}
          bottom: 2rem;
          right: 2rem;
      {%- endcase -%}
    {%- endif -%}
  }

  @media screen and (max-width: 749px) {
    #BannerCarousel-{{ section.id }} .banner-carousel__button {
      {%- if section.settings.button_use_custom_position_mobile -%}
        {%- if section.settings.button_top_mobile != blank -%}
          top: {{ section.settings.button_top_mobile }}px;
        {%- endif -%}
        {%- if section.settings.button_bottom_mobile != blank -%}
          bottom: {{ section.settings.button_bottom_mobile }}px;
        {%- endif -%}
        {%- if section.settings.button_left_mobile != blank -%}
          left: {{ section.settings.button_left_mobile }}px;
        {%- endif -%}
        {%- if section.settings.button_right_mobile != blank -%}
          right: {{ section.settings.button_right_mobile }}px;
        {%- endif -%}
        {%- if section.settings.button_center_horizontal_mobile and section.settings.button_center_vertical_mobile -%}
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        {%- elsif section.settings.button_center_horizontal_mobile -%}
          left: 50%;
          transform: translateX(-50%);
        {%- elsif section.settings.button_center_vertical_mobile -%}
          top: 50%;
          transform: translateY(-50%);
        {%- endif -%}
      {%- else -%}
        {%- case section.settings.button_position_mobile -%}
          {%- when 'top-left' -%}
            top: 1rem;
            left: 1rem;
            right: auto;
            bottom: auto;
            transform: none;
          {%- when 'top-center' -%}
            top: 1rem;
            left: 50%;
            right: auto;
            bottom: auto;
            transform: translateX(-50%);
          {%- when 'top-right' -%}
            top: 1rem;
            right: 1rem;
            left: auto;
            bottom: auto;
            transform: none;
          {%- when 'middle-left' -%}
            top: 50%;
            left: 1rem;
            right: auto;
            bottom: auto;
            transform: translateY(-50%);
          {%- when 'middle-center' -%}
            top: 50%;
            left: 50%;
            right: auto;
            bottom: auto;
            transform: translate(-50%, -50%);
          {%- when 'middle-right' -%}
            top: 50%;
            right: 1rem;
            left: auto;
            bottom: auto;
            transform: translateY(-50%);
          {%- when 'bottom-left' -%}
            bottom: 1rem;
            left: 1rem;
            top: auto;
            right: auto;
            transform: none;
          {%- when 'bottom-center' -%}
            bottom: 1rem;
            left: 50%;
            top: auto;
            right: auto;
            transform: translateX(-50%);
          {%- when 'bottom-right' -%}
            bottom: 1rem;
            right: 1rem;
            top: auto;
            left: auto;
            transform: none;
        {%- endcase -%}
      {%- endif -%}
    }
  }
{%- endstyle -%}

<slideshow-component
  id="BannerCarousel-{{ section.id }}"
  class="banner-carousel slider-mobile-gutter"
  role="region"
  aria-roledescription="{{ 'sections.slideshow.carousel' | t }}"
  aria-label="Banner carousel"
>
  <div
    class="slideshow banner banner--{{ section.settings.slide_height }} grid grid--1-col slider slider--everywhere{% if section.blocks.first.settings.image == blank and section.blocks.first.settings.image_mobile == blank %} slideshow--placeholder{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
    id="Slider-{{ section.id }}"
    aria-live="polite"
    aria-atomic="true"
    data-autoplay="true"
    data-speed="5"
  >
    {%- for block in section.blocks -%}
      <div
        class="slideshow__slide grid__item grid--1-col slider__slide banner-carousel__slide"
        id="Slide-{{ section.id }}-{{ forloop.index }}"
        {{ block.shopify_attributes }}
        role="group"
        aria-roledescription="{{ 'sections.slideshow.slide' | t }}"
        aria-label="{{ forloop.index }} {{ 'general.slider.of' | t }} {{ section.blocks.size }}"
        tabindex="-1"
      >
        {%- assign slide_link = block.settings.button_link -%}
        {%- if slide_link != blank -%}
          <a
            class="banner-carousel__media-link"
            href="{{ slide_link }}"
            {%- if block.settings.button_label != blank -%}
              aria-label="{{ block.settings.button_label | escape }}"
            {%- endif -%}
          >
        {%- endif -%}
        <div class="slideshow__media banner__media media banner-carousel__media{% if block.settings.image == blank and block.settings.image_mobile == blank %} placeholder{% endif %}">
          {%- liquid
            assign desktop_image = block.settings.image
            assign mobile_image = block.settings.image_mobile
            if mobile_image == blank
              assign mobile_image = desktop_image
            endif
          -%}

          {%- comment -%} Desktop Image {%- endcomment -%}
          {%- if desktop_image != blank -%}
            <div class="banner-carousel__image banner-carousel__image--desktop">
              {%- liquid
                assign height = desktop_image.width | divided_by: desktop_image.aspect_ratio | round
                assign sizes = '100vw'
                assign widths = '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
                assign fetch_priority = 'auto'
                if section.index == 1 and forloop.first
                  assign fetch_priority = 'high'
                endif
              -%}
              {%- if forloop.first -%}
                {{
                  desktop_image
                  | image_url: width: 3840
                  | image_tag:
                    height: height,
                    sizes: sizes,
                    widths: widths,
                    fetchpriority: fetch_priority,
                    class: 'banner-carousel__img'
                }}
              {%- else -%}
                {{
                  desktop_image
                  | image_url: width: 3840
                  | image_tag:
                    loading: 'lazy',
                    height: height,
                    sizes: sizes,
                    widths: widths,
                    class: 'banner-carousel__img'
                }}
              {%- endif -%}
            </div>
          {%- endif -%}

          {%- comment -%} Mobile Image {%- endcomment -%}
          {%- if mobile_image != blank -%}
            <div class="banner-carousel__image banner-carousel__image--mobile">
              {%- liquid
                assign height = mobile_image.width | divided_by: mobile_image.aspect_ratio | round
                assign sizes = '100vw'
                assign widths = '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
                assign fetch_priority = 'auto'
                if section.index == 1 and forloop.first
                  assign fetch_priority = 'high'
                endif
              -%}
              {%- if forloop.first -%}
                {{
                  mobile_image
                  | image_url: width: 3840
                  | image_tag:
                    height: height,
                    sizes: sizes,
                    widths: widths,
                    fetchpriority: fetch_priority,
                    class: 'banner-carousel__img'
                }}
              {%- else -%}
                {{
                  mobile_image
                  | image_url: width: 3840
                  | image_tag:
                    loading: 'lazy',
                    height: height,
                    sizes: sizes,
                    widths: widths,
                    class: 'banner-carousel__img'
                }}
              {%- endif -%}
            </div>
          {%- endif -%}

          {%- if desktop_image == blank and mobile_image == blank -%}
            {%- assign placeholder_slide = forloop.index | modulo: 2 -%}
            {%- if placeholder_slide == 1 -%}
              {{ 'hero-apparel-2' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- else -%}
              {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- endif -%}
          {%- endif -%}
        </div>

        {%- if slide_link != blank -%}
          </a>
        {%- endif -%}

        {%- if block.settings.button_link != blank and block.settings.button_label != blank -%}
          <a
            href="{{ block.settings.button_link }}"
            class="banner-carousel__button button"
          >
            {{ block.settings.button_label | escape }}
          </a>
        {%- endif -%}
      </div>
    {%- endfor -%}
  </div>

  {%- if section.blocks.size > 1 -%}
    <button
      type="button"
      class="banner-carousel__arrow banner-carousel__arrow--prev slider-button slider-button--prev"
      name="previous"
      aria-label="{{ 'sections.slideshow.previous_slideshow' | t }}"
      aria-controls="Slider-{{ section.id }}"
    >
      <span class="svg-wrapper">
        {{- 'icon-caret.svg' | inline_asset_content -}}
      </span>
    </button>
    <button
      type="button"
      class="banner-carousel__arrow banner-carousel__arrow--next slider-button slider-button--next"
      name="next"
      aria-label="{{ 'sections.slideshow.next_slideshow' | t }}"
      aria-controls="Slider-{{ section.id }}"
    >
      <span class="svg-wrapper">
        {{- 'icon-caret.svg' | inline_asset_content -}}
      </span>
    </button>
    <div class="banner-carousel__dots">
      <div class="slider-counter slider-counter--dots">
        <div class="slideshow__control-wrapper">
          {%- for block in section.blocks -%}
            <button
              class="slider-counter__link slider-counter__link--dots link"
              aria-label="{{ 'sections.slideshow.load_slide' | t }} {{ forloop.index }} {{ 'general.slider.of' | t }} {{ section.blocks.size }}"
              aria-controls="Slider-{{ section.id }}"
            >
              <span class="dot"></span>
            </button>
          {%- endfor -%}
        </div>
      </div>
    </div>
  {%- endif -%}
</slideshow-component>

<style>
  .banner-carousel {
    position: relative;
    overflow: hidden;
    width: 100%;
    display: block;
  }

  .banner-carousel__slide {
    position: relative;
  }

  .banner-carousel__media {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .banner-carousel__media-link {
    display: block;
    position: relative;
  }

  .banner-carousel__media-link:focus-visible {
    outline: 2px solid currentColor;
    outline-offset: 4px;
  }

  .banner-carousel__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .banner-carousel__image--desktop {
    display: block;
    z-index: 1;
  }

  .banner-carousel__image--mobile {
    display: none;
    z-index: 0;
  }

  .banner-carousel__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .banner-carousel__button {
    z-index: 2;
    padding: 1.2rem 2.4rem;
    text-decoration: none;
    font-weight: 500;
    transition: opacity 0.3s ease;
    border: none;
    cursor: pointer;
    display: inline-block;
  }

  .banner-carousel__button:hover {
    opacity: 0.9;
  }

  .banner-carousel__arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 3;
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 50%;
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .banner-carousel__arrow:hover {
    color: rgb(255, 255, 255);
    background: rgba(255, 255, 255, 0.2);
  }

  .banner-carousel__arrow--prev {
    left: 2rem;
  }

  .banner-carousel__arrow--next {
    right: 2rem;
  }

  .banner-carousel__dots {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    padding: 0.8rem 1.5rem;
    border-radius: 50px;
  }

  .banner-carousel__dots .slider-counter__link--dots .dot {
    background-color: rgba(255, 255, 255, 0.5);
    border-color: rgba(255, 255, 255, 0.5);
  }

  .banner-carousel__dots .slider-counter__link--dots.slider-counter__link--active .dot {
    background-color: rgb(255, 255, 255);
    border-color: rgb(255, 255, 255);
  }

  .banner-carousel__dots .slider-counter__link--dots:not(.slider-counter__link--active):hover .dot {
    border-color: rgb(255, 255, 255);
    background-color: rgba(255, 255, 255, 0.7);
  }

  @media screen and (max-width: 749px) {
    .banner-carousel__image--desktop {
      display: none !important;
      visibility: hidden !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }

    .banner-carousel__image--mobile {
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 1 !important;
    }

    .banner-carousel__button {
      padding: 1rem 2rem;
      font-size: 1.4rem;
    }

    .banner-carousel__arrow {
      width: 36px;
      height: 36px;
    }

    .banner-carousel__arrow--prev {
      left: 1rem;
    }

    .banner-carousel__arrow--next {
      right: 1rem;
    }

    .banner-carousel__dots {
      bottom: 1rem;
      padding: 0.6rem 1.2rem;
    }
  }
</style>

{%- if request.design_mode -%}
  <script src="{{ 'theme-editor.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{% schema %}
{
  "name": "Banner Carousel",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "select",
      "id": "slide_height",
      "options": [
        {
          "value": "adapt_image",
          "label": "Adapt to image"
        },
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ],
      "default": "medium",
      "label": "Slide height"
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 0
    },
    {
      "type": "select",
      "id": "button_position",
      "label": "Button position (Desktop)",
      "options": [
        {
          "value": "top-left",
          "label": "Top left"
        },
        {
          "value": "top-center",
          "label": "Top center"
        },
        {
          "value": "top-right",
          "label": "Top right"
        },
        {
          "value": "middle-left",
          "label": "Middle left"
        },
        {
          "value": "middle-center",
          "label": "Middle center"
        },
        {
          "value": "middle-right",
          "label": "Middle right"
        },
        {
          "value": "bottom-left",
          "label": "Bottom left"
        },
        {
          "value": "bottom-center",
          "label": "Bottom center"
        },
        {
          "value": "bottom-right",
          "label": "Bottom right"
        }
      ],
      "default": "middle-center"
    },
    {
      "type": "select",
      "id": "button_position_mobile",
      "label": "Button position (Mobile)",
      "options": [
        {
          "value": "top-left",
          "label": "Top left"
        },
        {
          "value": "top-center",
          "label": "Top center"
        },
        {
          "value": "top-right",
          "label": "Top right"
        },
        {
          "value": "middle-left",
          "label": "Middle left"
        },
        {
          "value": "middle-center",
          "label": "Middle center"
        },
        {
          "value": "middle-right",
          "label": "Middle right"
        },
        {
          "value": "bottom-left",
          "label": "Bottom left"
        },
        {
          "value": "bottom-center",
          "label": "Bottom center"
        },
        {
          "value": "bottom-right",
          "label": "Bottom right"
        }
      ],
      "default": "middle-center"
    },
    {
      "type": "header",
      "content": "Custom Button Position (Desktop)"
    },
    {
      "type": "checkbox",
      "id": "button_use_custom_position_desktop",
      "label": "Use custom position (Desktop)",
      "default": false,
      "info": "Enable to use pixel-based positioning instead of preset positions"
    },
    {
      "type": "number",
      "id": "button_top_desktop",
      "label": "Top (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_bottom_desktop",
      "label": "Bottom (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_left_desktop",
      "label": "Left (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_right_desktop",
      "label": "Right (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "checkbox",
      "id": "button_center_horizontal_desktop",
      "label": "Center horizontally",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "button_center_vertical_desktop",
      "label": "Center vertically",
      "default": false
    },
    {
      "type": "header",
      "content": "Custom Button Position (Mobile)"
    },
    {
      "type": "checkbox",
      "id": "button_use_custom_position_mobile",
      "label": "Use custom position (Mobile)",
      "default": false,
      "info": "Enable to use pixel-based positioning instead of preset positions"
    },
    {
      "type": "number",
      "id": "button_top_mobile",
      "label": "Top (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_bottom_mobile",
      "label": "Bottom (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_left_mobile",
      "label": "Left (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "number",
      "id": "button_right_mobile",
      "label": "Right (px)",
      "info": "Leave empty to not set"
    },
    {
      "type": "checkbox",
      "id": "button_center_horizontal_mobile",
      "label": "Center horizontally",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "button_center_vertical_mobile",
      "label": "Center vertically",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "header",
          "content": "Images"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Desktop image"
        },
        {
          "type": "image_picker",
          "id": "image_mobile",
          "label": "Mobile image",
          "info": "If not set, desktop image will be used on mobile"
        },
        {
          "type": "header",
          "content": "Button"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Shop Now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Banner Carousel",
      "blocks": [
        {
          "type": "slide"
        },
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
